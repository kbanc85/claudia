{
  "hooks": [
    {
      "event": "session_start",
      "description": "Load context and catch up on unsummarized sessions",
      "behavior": {
        "action": "load_memory",
        "files": [
          "context/me.md",
          "context/learnings.md",
          "context/patterns.md",
          "context/commitments.md",
          "context/waiting.md"
        ],
        "on_missing_me": "trigger_onboarding",
        "enhanced_memory": {
          "catch_up": "Call memory.unsummarized to find sessions that ended without a summary. For each, review the buffered turns and call memory.end_session with a retroactive narrative and structured extractions.",
          "recall_context": "Call memory.recall and memory.predictions to load relevant context and proactive suggestions."
        }
      }
    },
    {
      "event": "session_end",
      "description": "Generate session summary and persist updates",
      "behavior": {
        "action": "save_memory",
        "files": [
          "context/learnings.md",
          "context/patterns.md",
          "context/commitments.md",
          "context/waiting.md"
        ],
        "save_mode": "merge",
        "enhanced_memory": {
          "summarize": "Call memory.end_session with a narrative summary and structured extractions from the session's buffered turns. The narrative should enhance stored information with tone, context, unresolved threads, and nuance that structured fields cannot capture."
        }
      }
    },
    {
      "event": "first_run",
      "description": "Detect first run and trigger onboarding",
      "behavior": {
        "action": "check_file",
        "file": "context/me.md",
        "on_missing": "trigger_skill:onboarding"
      }
    }
  ],
  "notes": {
    "implementation": "These hooks define intended behaviors. Claude Code will execute them as behavioral guidelines rather than traditional script execution.",
    "session_start": "At session start, Claudia should read context files to restore memory. If me.md is missing, onboarding should begin. If enhanced memory is available, check for unsummarized sessions first and generate retroactive summaries before proceeding.",
    "session_end": "Before session ends, Claudia should generate a session summary (enhanced memory) or update context files (markdown fallback). The summary includes both a free-form narrative and structured extractions.",
    "first_run": "The absence of context/me.md signals a first-run scenario requiring onboarding.",
    "turn_buffering": "During sessions with enhanced memory, Claudia buffers each meaningful conversation turn via memory.buffer_turn. This ensures nothing is lost even if the session ends abruptly. The buffered turns are summarized at session end or caught up at next session start."
  }
}
